<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Rotating Injection Sites</title>
<meta name="viewport" content="width=device-width">
<meta name="mobile-web-app-capable" content="yes">
<link rel="shortcut icon" sizes="192x192" href="Injection192.png">
<style type="text/css">
  body {
    display: flex;
  }
  body, button {
    font-family: sans-serif;
    font-size: 2vw;
  }
  .wrapper {
    position: relative;
    width: 50%;
  }
  div, button, canvas {
    position: absolute;
  }
  .label, .site, .currentsite, button {
    text-align: center;
    padding: 0.3em;
    background-clip: padding-border;
    border-radius: 0.7em;
  }
  .label {
    background-color: white;
    font-weight: bold;
  }
  .site {
    color: black;
    background-color: transparent;
    font-weight: normal;
  }
  .currentsite {
    color: white;
    background-color: red;
    font-weight: bold;
  }
  button {
    width: 3.5em;
    height: 2.5em;
  }
  .upLabel {
    text-align: center;
    width: 100%;
    font-weight: bold;
    padding: 0.3em 0;
  }
</style>
</head>
<body>
  <div class="wrapper">
    <canvas id="canvas2"></canvas>
    <div class="label" style="left: 21.7vw; top: 23.9vw;">Left<br>Side</div>
    <div class="site" style="left: 40.1vw; top: 28.3vw;">Sun<br>Lunch</div>
    <div class="site" style="left:  2.4vw; top: 19.6vw;">Sun<br>Night</div>
    <div class="site" style="left: 21.1vw; top: 43.5vw;">Mon<br>Lunch</div>
    <div class="site" style="left: 21.5vw; top:  4.4vw;">Mon<br>Night</div>
    <div class="site" style="left:  2.0vw; top: 28.3vw;">Tue<br>Lunch</div>
    <div class="site" style="left: 40.5vw; top: 19.6vw;">Tue<br>Night</div>
    <div class="site" style="left: 12.6vw; top:  6.3vw;">Wed<br>Lunch</div>
    <div class="site" style="left: 30.0vw; top: 41.6vw;">Wed<br>Night</div>
    <div class="site" style="left: 36.3vw; top: 11.8vw;">Thu<br>Lunch</div>
    <div class="site" style="left:  6.2vw; top: 36.1vw;">Thu<br>Night</div>
    <div class="site" style="left: 36.3vw; top: 36.1vw;">Fri<br>Lunch</div>
    <div class="site" style="left:  6.2vw; top: 11.8vw;">Fri<br>Night</div>
    <div class="site" style="left: 12.6vw; top: 41.6vw;">Sat<br>Lunch</div>
    <div class="site" style="left: 30.0vw; top:  6.3vw;">Sat<br>Night</div>
    <button onclick="showSite(-1)" style="right:0.5em">Prev</button>
  </div>
  <div class="wrapper">
    <canvas id="canvas1"></canvas>
    <div class="label" style="left: 21.2vw; top: 23.9vw;">Right<br>Side</div>
    <div class="site" style="left: 21.2vw; top: 43.5vw;">Sun<br>Brkfst</div>
    <div class="site" style="left:  1.8vw; top: 19.6vw;">Sun<br>Dinner</div>
    <div class="site" style="left:  2.2vw; top: 28.3vw;">Mon<br>Brkfst</div>
    <div class="site" style="left: 20.9vw; top:  4.4vw;">Mon<br>Dinner</div>
    <div class="site" style="left: 12.7vw; top:  6.3vw;">Tue<br>Brkfst</div>
    <div class="site" style="left: 39.9vw; top: 19.6vw;">Tue<br>Dinner</div>
    <div class="site" style="left: 36.5vw; top: 11.8vw;">Wed<br>Brkfst</div>
    <div class="site" style="left: 29.3vw; top: 41.6vw;">Wed<br>Dinner</div>
    <div class="site" style="left: 36.5vw; top: 36.1vw;">Thu<br>Brkfst</div>
    <div class="site" style="left:  5.6vw; top: 36.1vw;">Thu<br>Dinner</div>
    <div class="site" style="left: 40.1vw; top: 28.3vw;">Fri<br>Brkfst</div>
    <div class="site" style="left:  5.6vw; top: 11.8vw;">Fri<br>Dinner</div>
    <div class="site" style="left: 12.7vw; top: 41.6vw;">Sat<br>Brkfst</div>
    <div class="site" style="left: 29.3vw; top:  6.3vw;">Sat<br>Dinner</div>
    <button onclick="showSite(1)" style="left:0.5em">Next</button>
  </div>
  <div class="upLabel" style="font-size:2.4rem;top:49vw;">↓ Up ↓</div>
<script type="application/javascript">

  var sites = [];

  function oneSide(canvas) {

    // because we can't set canvas size in "vw" units
    canvas.height = 1.1 * (canvas.width = window.innerWidth / 2);

    // find the injection site elements
    var wrapper = canvas.parentElement;
    var i, site;
    for (i = 0; i < wrapper.children.length; i++) {
	  site = wrapper.children[i];
	  if (site.className == "site") {
	    sites.push(site);
	  }
    }

    // draw the "compass rose"
    var ctx = canvas.getContext("2d");
    var radius = canvas.width * .4;
    ctx.strokeStyle = "cornflowerblue";
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    var l, angle, xoff, yoff;
    for (i = 0; i < 7; i++) {
      l = radius * .8;
      angle = Math.PI * i / 7;
      xoff = Math.sin(angle) * l;
      yoff = Math.cos(angle) * l;
      ctx.moveTo(canvas.width / 2 + xoff, canvas.height / 2 + yoff);
      ctx.lineTo(canvas.width / 2 - xoff, canvas.height / 2 - yoff);
    }
    ctx.stroke();

  }

  oneSide(document.getElementById("canvas1"));
  oneSide(document.getElementById("canvas2"));

  function segment(day, hour) {
    // hard-coding (for now) these time periods:
    // 10:00pm - 03:59am : night
    // 04:00am - 10:59am : breakfast
    // 11:00am - 03:59pm : lunch
    // 04:00am - 09:59pm : dinner
    if (hour > 21) return day * 4 + 3;
    if (hour > 15) return day * 4 + 2;
    if (hour > 10) return day * 4 + 1;
    if (hour >  3) return day * 4;
    return (day * 4 + 27) % 28;		// previous night
  }

  // highlight the current injection site
  /*let*/ d = new Date();
  /*let*/ current = segment(d.getDay(), d.getHours());

  function mapLabel(curr) {
    // determine label position (side and index)
    return (curr & 1) * 14 + (curr >> 1);
  }

  function showSite(inc) {
    if (inc != 0) {
      sites[mapLabel(current)].className = "site"; // remove old highlight
      current = (current + inc + 28) % 28;
    }
    sites[mapLabel(current)].className = "currentsite";
  }

  showSite(0);

</script>
</body>
</html>
